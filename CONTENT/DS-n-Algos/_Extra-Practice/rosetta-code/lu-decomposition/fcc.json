{
  "title": "LU decomposition",
  "htmlDescription": "<section id=\"description\">\n<p>Every square matrix $A$ can be decomposed into a product of a lower triangular matrix $L$ and a upper triangular matrix $U$, as described in <a href=\"https://en.wikipedia.org/wiki/LU%20decomposition\">LU decomposition</a>.</p>\n<p>$A = LU$</p>\n<p>It is a modified form of Gaussian elimination.</p>\n<p>While the <a href=\"http://rosettacode.org/wiki/Cholesky%20decomposition\">Cholesky decomposition</a> only works for symmetric, positive definite matrices, the more general LU decomposition works for any square matrix.</p>\n<p>There are several algorithms for calculating $L$ and $U$.</p>\n<p>To derive <em>Crout's algorithm</em> for a 3x3 example, we have to solve the following system:</p>\n<p>\\begin{align}A = \\begin{pmatrix} a_{11} &#x26; a_{12} &#x26; a_{13}\\\\ a_{21} &#x26; a_{22} &#x26; a_{23}\\\\ a_{31} &#x26; a_{32} &#x26; a_{33}\\\\ \\end{pmatrix}= \\begin{pmatrix} l_{11} &#x26; 0 &#x26; 0 \\\\ l_{21} &#x26; l_{22} &#x26; 0 \\\\ l_{31} &#x26; l_{32} &#x26; l_{33}\\\\ \\end{pmatrix} \\begin{pmatrix} u_{11} &#x26; u_{12} &#x26; u_{13} \\\\ 0 &#x26; u_{22} &#x26; u_{23} \\\\ 0 &#x26; 0 &#x26; u_{33} \\end{pmatrix} = LU\\end{align}</p>\n<p>We now would have to solve 9 equations with 12 unknowns. To make the system uniquely solvable, usually the diagonal elements of $L$ are set to 1</p>\n<p>$l_{11}=1$</p>\n<p>$l_{22}=1$</p>\n<p>$l_{33}=1$</p>\n<p>so we get a solvable system of 9 unknowns and 9 equations.</p>\n<p>\\begin{align}A = \\begin{pmatrix} a_{11} &#x26; a_{12} &#x26; a_{13}\\\\ a_{21} &#x26; a_{22} &#x26; a_{23}\\\\ a_{31} &#x26; a_{32} &#x26; a_{33}\\\\ \\end{pmatrix} = \\begin{pmatrix} 1 &#x26; 0 &#x26; 0 \\\\ l_{21} &#x26; 1 &#x26; 0 \\\\ l_{31} &#x26; l_{32} &#x26; 1\\\\ \\end{pmatrix} \\begin{pmatrix} u_{11} &#x26; u_{12} &#x26; u_{13} \\\\ 0 &#x26; u_{22} &#x26; u_{23} \\\\ 0 &#x26; 0 &#x26; u_{33} \\end{pmatrix} = \\begin{pmatrix} u_{11} &#x26; u_{12} &#x26; u_{13} \\\\ u_{11}l_{21} &#x26; u_{12}l_{21}+u_{22} &#x26; u_{13}l_{21}+u_{23} \\\\ u_{11}l_{31} &#x26; u_{12}l_{31}+u_{22}l_{32} &#x26; u_{13}l_{31} + u_{23}l_{32}+u_{33} \\end{pmatrix} = LU\\end{align}</p>\n<p>Solving for the other $l$ and $u$, we get the following equations:</p>\n<p>$u_{11}=a_{11}$</p>\n<p>$u_{12}=a_{12}$</p>\n<p>$u_{13}=a_{13}$</p>\n<p>$u_{22}=a_{22} - u_{12}l_{21}$</p>\n<p>$u_{23}=a_{23} - u_{13}l_{21}$</p>\n<p>$u_{33}=a_{33} - (u_{13}l_{31} + u_{23}l_{32})$</p>\n<p>and for $l$:</p>\n<p>$l_{21}=\\frac{1}{u_{11}} a_{21}$</p>\n<p>$l_{31}=\\frac{1}{u_{11}} a_{31}$</p>\n<p>$l_{32}=\\frac{1}{u_{22}} (a_{32} - u_{12}l_{31})$</p>\n<p>We see that there is a calculation pattern, which can be expressed as the following formulas, first for $U$</p>\n<p>$u_{ij} = a_{ij} - \\sum_{k=1}^{i-1} u_{kj}l_{ik}$</p>\n<p>and then for $L$</p>\n<p>$l_{ij} = \\frac{1}{u_{jj}} (a_{ij} - \\sum_{k=1}^{j-1} u_{kj}l_{ik})$</p>\n<p>We see in the second formula that to get the $l_{ij}$ below the diagonal, we have to divide by the diagonal element (pivot) $u_{jj}$, so we get problems when $u_{jj}$ is either 0 or very small, which leads to numerical instability.</p>\n<p>The solution to this problem is <em>pivoting</em> $A$, which means rearranging the rows of $A$, prior to the $LU$ decomposition, in a way that the largest element of each column gets onto the diagonal of $A$. Rearranging the rows means to multiply $A$ by a permutation matrix $P$:</p>\n<p>$PA \\Rightarrow A'$</p>\n<p>Example:</p>\n<p>\\begin{align} \\begin{pmatrix} 0 &#x26; 1 \\\\ 1 &#x26; 0 \\end{pmatrix} \\begin{pmatrix} 1 &#x26; 4 \\\\ 2 &#x26; 3 \\end{pmatrix} \\Rightarrow \\begin{pmatrix} 2 &#x26; 3 \\\\ 1 &#x26; 4 \\end{pmatrix} \\end{align}</p>\n<p>The decomposition algorithm is then applied on the rearranged matrix so that</p>\n<p>$PA = LU$</p>\n</section>",
  "boilerplate": "function luDecomposition(A) {\n\n}",
  "url": "https://www.freecodecamp.org/learn/coding-interview-prep/rosetta-code/lu-decomposition"
}