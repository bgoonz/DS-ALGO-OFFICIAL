<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="pandoc" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />
    <title>readme</title>
    <style type="text/css">
      code {
        white-space: pre-wrap;
      }
      span.smallcaps {
        font-variant: small-caps;
      }
      span.underline {
        text-decoration: underline;
      }
      div.column {
        display: inline-block;
        vertical-align: top;
        width: 50%;
      }
    </style>
  </head>
  <body>
    <h1 id="lu-decomposition">LU decomposition</h1>
    <p>
      <a
        href="https://www.freecodecamp.org/learn/coding-interview-prep/rosetta-code/lu-decomposition"
        >FCC link</a
      >
    </p>
    <p>
      Every square matrix <span class="math inline"><em>A</em></span> can be
      decomposed into a product of a lower triangular matrix
      <span class="math inline"><em>L</em></span> and a upper triangular matrix
      <span class="math inline"><em>U</em></span
      >, as described in
      <a href="https://en.wikipedia.org/wiki/LU%20decomposition"
        >LU decomposition</a
      >.
    </p>
    <p>
      <span class="math inline"><em>A</em> = <em>L</em><em>U</em></span>
    </p>
    <p>It is a modified form of Gaussian elimination.</p>
    <p>
      While the
      <a href="http://rosettacode.org/wiki/Cholesky%20decomposition"
        >Cholesky decomposition</a
      >
      only works for symmetric, positive definite matrices, the more general LU
      decomposition works for any square matrix.
    </p>
    <p>
      There are several algorithms for calculating
      <span class="math inline"><em>L</em></span> and
      <span class="math inline"><em>U</em></span
      >.
    </p>
    <p>
      To derive <em>Crout’s algorithm</em> for a 3x3 example, we have to solve
      the following system:
    </p>
    <p>
      \begin{align}A = \begin{pmatrix} a_{11} &amp; a_{12} &amp; a_{13}\\ a_{21}
      &amp; a_{22} &amp; a_{23}\\ a_{31} &amp; a_{32} &amp; a_{33}\\
      \end{pmatrix}= \begin{pmatrix} l_{11} &amp; 0 &amp; 0 \\ l_{21} &amp;
      l_{22} &amp; 0 \\ l_{31} &amp; l_{32} &amp; l_{33}\\ \end{pmatrix}
      \begin{pmatrix} u_{11} &amp; u_{12} &amp; u_{13} \\ 0 &amp; u_{22} &amp;
      u_{23} \\ 0 &amp; 0 &amp; u_{33} \end{pmatrix} = LU\end{align}
    </p>
    <p>
      We now would have to solve 9 equations with 12 unknowns. To make the
      system uniquely solvable, usually the diagonal elements of
      <span class="math inline"><em>L</em></span> are set to 1
    </p>
    <p>
      <span class="math inline"><em>l</em>_11 = 1</span>
    </p>
    <p>
      <span class="math inline"><em>l</em>_22 = 1</span>
    </p>
    <p>
      <span class="math inline"><em>l</em>_33 = 1</span>
    </p>
    <p>so we get a solvable system of 9 unknowns and 9 equations.</p>
    <p>
      \begin{align}A = \begin{pmatrix} a_{11} &amp; a_{12} &amp; a_{13}\\ a_{21}
      &amp; a_{22} &amp; a_{23}\\ a_{31} &amp; a_{32} &amp; a_{33}\\
      \end{pmatrix} = \begin{pmatrix} 1 &amp; 0 &amp; 0 \\ l_{21} &amp; 1 &amp;
      0 \\ l_{31} &amp; l_{32} &amp; 1\\ \end{pmatrix} \begin{pmatrix} u_{11}
      &amp; u_{12} &amp; u_{13} \\ 0 &amp; u_{22} &amp; u_{23} \\ 0 &amp; 0
      &amp; u_{33} \end{pmatrix} = \begin{pmatrix} u_{11} &amp; u_{12} &amp;
      u_{13} \\ u_{11}l_{21} &amp; u_{12}l_{21}+u_{22} &amp; u_{13}l_{21}+u_{23}
      \\ u_{11}l_{31} &amp; u_{12}l_{31}+u_{22}l_{32} &amp; u_{13}l_{31} +
      u_{23}l_{32}+u_{33} \end{pmatrix} = LU\end{align}
    </p>
    <p>
      Solving for the other <span class="math inline"><em>l</em></span> and
      <span class="math inline"><em>u</em></span
      >, we get the following equations:
    </p>
    <p>
      <span class="math inline"><em>u</em>_11 = <em>a</em>_11</span>
    </p>
    <p>
      <span class="math inline"><em>u</em>_12 = <em>a</em>_12</span>
    </p>
    <p>
      <span class="math inline"><em>u</em>_13 = <em>a</em>_13</span>
    </p>
    <p>
      <span class="math inline"
        ><em>u</em>_22 = <em>a</em>_22 − <em>u</em>_12<em>l</em>_21</span
      >
    </p>
    <p>
      <span class="math inline"
        ><em>u</em>_23 = <em>a</em>_23 − <em>u</em>_13<em>l</em>_21</span
      >
    </p>
    <p>
      <span class="math inline"
        ><em>u</em
        >_33 = <em>a</em>_33 − (<em>u</em>_13<em>l</em>_31 + <em>u</em>_23<em>l</em>_32)</span
      >
    </p>
    <p>
      and for <span class="math inline"><em>l</em></span
      >:
    </p>
    <p><span class="math inline">$l\_{21}=\\frac{1}{u\_{11}} a\_{21}$</span></p>
    <p><span class="math inline">$l\_{31}=\\frac{1}{u\_{11}} a\_{31}$</span></p>
    <p>
      <span class="math inline"
        >$l\_{32}=\\frac{1}{u\_{22}} (a\_{32} - u\_{12}l\_{31})$</span
      >
    </p>
    <p>
      We see that there is a calculation pattern, which can be expressed as the
      following formulas, first for <span class="math inline"><em>U</em></span>
    </p>
    <p>
      <span class="math inline"
        >$u\_{ij} = a\_{ij} - \\sum\_{k=1}^{i-1} u\_{kj}l\_{ik}$</span
      >
    </p>
    <p>
      and then for <span class="math inline"><em>L</em></span>
    </p>
    <p>
      <span class="math inline"
        >$l\_{ij} = \\frac{1}{u\_{jj}} (a\_{ij} - \\sum\_{k=1}^{j-1}
        u\_{kj}l\_{ik})$</span
      >
    </p>
    <p>
      We see in the second formula that to get the
      <span class="math inline"><em>l</em>_<em>i</em><em>j</em></span> below the
      diagonal, we have to divide by the diagonal element (pivot)
      <span class="math inline"><em>u</em>_<em>j</em><em>j</em></span
      >, so we get problems when
      <span class="math inline"><em>u</em>_<em>j</em><em>j</em></span> is either
      0 or very small, which leads to numerical instability.
    </p>
    <p>
      The solution to this problem is <em>pivoting</em>
      <span class="math inline"><em>A</em></span
      >, which means rearranging the rows of
      <span class="math inline"><em>A</em></span
      >, prior to the
      <span class="math inline"><em>L</em><em>U</em></span> decomposition, in a
      way that the largest element of each column gets onto the diagonal of
      <span class="math inline"><em>A</em></span
      >. Rearranging the rows means to multiply
      <span class="math inline"><em>A</em></span> by a permutation matrix
      <span class="math inline"><em>P</em></span
      >:
    </p>
    <p><span class="math inline">$PA \\Rightarrow A'$</span></p>
    <p>Example:</p>
    <p>
      \begin{align} \begin{pmatrix} 0 &amp; 1 \\ 1 &amp; 0 \end{pmatrix}
      \begin{pmatrix} 1 &amp; 4 \\ 2 &amp; 3 \end{pmatrix} \Rightarrow
      \begin{pmatrix} 2 &amp; 3 \\ 1 &amp; 4 \end{pmatrix} \end{align}
    </p>
    <p>
      The decomposition algorithm is then applied on the rearranged matrix so
      that
    </p>
    <p>
      <span class="math inline"
        ><em>P</em><em>A</em> = <em>L</em><em>U</em></span
      >
    </p>
  </body>
</html>
